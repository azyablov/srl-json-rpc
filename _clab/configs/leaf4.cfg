    acl {
        cpm-filter {
            ipv4-filter {
                statistics-per-entry true
                entry 10 {
                    description "Accept incoming ICMP unreachable messages"
                    action {
                        accept {
                            rate-limit {
                                system-cpu-policer icmp
                            }
                        }
                    }
                    match {
                        protocol icmp
                        icmp {
                            type dest-unreachable
                            code [
                                0
                                1
                                2
                                3
                                4
                                13
                            ]
                        }
                    }
                }
                entry 20 {
                    description "Accept incoming ICMP time-exceeded messages"
                    action {
                        accept {
                            rate-limit {
                                system-cpu-policer icmp
                            }
                        }
                    }
                    match {
                        protocol icmp
                        icmp {
                            type time-exceeded
                        }
                    }
                }
                entry 30 {
                    description "Accept incoming ICMP parameter problem messages"
                    action {
                        accept {
                            rate-limit {
                                system-cpu-policer icmp
                            }
                        }
                    }
                    match {
                        protocol icmp
                        icmp {
                            type param-problem
                        }
                    }
                }
                entry 40 {
                    description "Accept incoming ICMP echo messages"
                    action {
                        accept {
                            rate-limit {
                                system-cpu-policer icmp
                            }
                        }
                    }
                    match {
                        protocol icmp
                        icmp {
                            type echo
                        }
                    }
                }
                entry 50 {
                    description "Accept incoming ICMP echo-reply messages"
                    action {
                        accept {
                            rate-limit {
                                system-cpu-policer icmp
                            }
                        }
                    }
                    match {
                        protocol icmp
                        icmp {
                            type echo-reply
                        }
                    }
                }
                entry 60 {
                    description "Accept incoming SSH when the other host initiates the TCP connection"
                    action {
                        accept {
                        }
                    }
                    match {
                        protocol tcp
                        destination-port {
                            operator eq
                            value 22
                        }
                    }
                }
                entry 70 {
                    description "Accept incoming SSH when this router initiates the TCP connection"
                    action {
                        accept {
                        }
                    }
                    match {
                        protocol tcp
                        source-port {
                            operator eq
                            value 22
                        }
                    }
                }
                entry 80 {
                    description "Accept incoming Telnet when the other host initiates the TCP connection"
                    action {
                        accept {
                        }
                    }
                    match {
                        protocol tcp
                        destination-port {
                            operator eq
                            value 23
                        }
                    }
                }
                entry 90 {
                    description "Accept incoming Telnet when this router initiates the TCP connection"
                    action {
                        accept {
                        }
                    }
                    match {
                        protocol tcp
                        source-port {
                            operator eq
                            value 23
                        }
                    }
                }
                entry 100 {
                    description "Accept incoming TACACS+ when the other host initiates the TCP connection"
                    action {
                        accept {
                        }
                    }
                    match {
                        protocol tcp
                        destination-port {
                            operator eq
                            value 49
                        }
                    }
                }
                entry 110 {
                    description "Accept incoming TACACS+ when this router initiates the TCP connection"
                    action {
                        accept {
                        }
                    }
                    match {
                        protocol tcp
                        source-port {
                            operator eq
                            value 49
                        }
                    }
                }
                entry 120 {
                    description "Accept incoming DNS response messages"
                    action {
                        accept {
                        }
                    }
                    match {
                        protocol udp
                        source-port {
                            operator eq
                            value 53
                        }
                    }
                }
                entry 130 {
                    description "Accept incoming DHCP messages targeted for BOOTP/DHCP client"
                    action {
                        accept {
                        }
                    }
                    match {
                        protocol udp
                        destination-port {
                            operator eq
                            value 68
                        }
                    }
                }
                entry 140 {
                    description "Accept incoming TFTP read-request and write-request messages"
                    action {
                        accept {
                        }
                    }
                    match {
                        protocol udp
                        destination-port {
                            operator eq
                            value 69
                        }
                    }
                }
                entry 150 {
                    description "Accept incoming HTTP(JSON-RPC) when the other host initiates the TCP connection"
                    action {
                        accept {
                        }
                    }
                    match {
                        protocol tcp
                        destination-port {
                            operator eq
                            value 80
                        }
                    }
                }
                entry 160 {
                    description "Accept incoming HTTP(JSON-RPC) when this router initiates the TCP connection"
                    action {
                        accept {
                        }
                    }
                    match {
                        protocol tcp
                        source-port {
                            operator eq
                            value 80
                        }
                    }
                }
                entry 170 {
                    description "Accept incoming NTP messages from servers"
                    action {
                        accept {
                        }
                    }
                    match {
                        protocol udp
                        source-port {
                            operator eq
                            value 123
                        }
                    }
                }
                entry 180 {
                    description "Accept incoming SNMP GET/GETNEXT messages from servers"
                    action {
                        accept {
                        }
                    }
                    match {
                        protocol udp
                        destination-port {
                            operator eq
                            value 161
                        }
                    }
                }
                entry 190 {
                    description "Accept incoming BGP when the other router initiates the TCP connection"
                    action {
                        accept {
                        }
                    }
                    match {
                        protocol tcp
                        destination-port {
                            operator eq
                            value 179
                        }
                    }
                }
                entry 200 {
                    description "Accept incoming BGP when this router initiates the TCP connection"
                    action {
                        accept {
                        }
                    }
                    match {
                        protocol tcp
                        source-port {
                            operator eq
                            value 179
                        }
                    }
                }
                entry 210 {
                    description "Accept incoming HTTPS(JSON-RPC) when the other host initiates the TCP connection"
                    action {
                        accept {
                        }
                    }
                    match {
                        protocol tcp
                        destination-port {
                            operator eq
                            value 443
                        }
                    }
                }
                entry 220 {
                    description "Accept incoming HTTPS(JSON-RPC) when this router initiates the TCP connection"
                    action {
                        accept {
                        }
                    }
                    match {
                        protocol tcp
                        source-port {
                            operator eq
                            value 443
                        }
                    }
                }
                entry 230 {
                    description "Accept incoming single-hop BFD session messages"
                    action {
                        accept {
                        }
                    }
                    match {
                        protocol udp
                        destination-port {
                            operator eq
                            value 3784
                        }
                    }
                }
                entry 240 {
                    description "Accept incoming multi-hop BFD session messages"
                    action {
                        accept {
                        }
                    }
                    match {
                        protocol udp
                        destination-port {
                            operator eq
                            value 4784
                        }
                    }
                }
                entry 250 {
                    description "Accept incoming uBFD session messages"
                    action {
                        accept {
                        }
                    }
                    match {
                        protocol udp
                        destination-port {
                            operator eq
                            value 6784
                        }
                    }
                }
                entry 260 {
                    description "Accept incoming gNMI messages when the other host initiates the TCP connection"
                    action {
                        accept {
                        }
                    }
                    match {
                        protocol tcp
                        destination-port {
                            operator eq
                            value 57400
                        }
                    }
                }
                entry 270 {
                    description "Accept incoming UDP traceroute messages"
                    action {
                        accept {
                        }
                    }
                    match {
                        protocol udp
                        destination-port {
                            range {
                                start 33434
                                end 33464
                            }
                        }
                    }
                }
                entry 280 {
                    description "Accept incoming ICMP timestamp messages"
                    action {
                        accept {
                            rate-limit {
                                system-cpu-policer icmp
                            }
                        }
                    }
                    match {
                        protocol icmp
                        icmp {
                            type timestamp
                        }
                    }
                }
                entry 290 {
                    description "Accept incoming OSPF messages"
                    action {
                        accept {
                        }
                    }
                    match {
                        protocol 89
                    }
                }
                entry 300 {
                    description "Accept incoming DHCP relay messages targeted for BOOTP/DHCP server"
                    action {
                        accept {
                        }
                    }
                    match {
                        protocol udp
                        destination-port {
                            operator eq
                            value 67
                        }
                    }
                }
                entry 310 {
                    description "Accept ICMP fragment packets"
                    action {
                        accept {
                            rate-limit {
                                system-cpu-policer icmp
                            }
                        }
                    }
                    match {
                        fragment true
                        protocol icmp
                    }
                }
                entry 320 {
                    description "Accept incoming LDP packets"
                    action {
                        accept {
                        }
                    }
                    match {
                        protocol udp
                        source-port {
                            operator eq
                            value 646
                        }
                    }
                }
                entry 330 {
                    description "Accept incoming LDP packets with source-port 646"
                    action {
                        accept {
                        }
                    }
                    match {
                        protocol tcp
                        source-port {
                            operator eq
                            value 646
                        }
                    }
                }
                entry 340 {
                    description "Accept incoming LDP packets with destination-port 646"
                    action {
                        accept {
                        }
                    }
                    match {
                        protocol tcp
                        destination-port {
                            operator eq
                            value 646
                        }
                    }
                }
                entry 350 {
                    description "Accept incoming gRIBI packets with destination-port 57401"
                    action {
                        accept {
                        }
                    }
                    match {
                        protocol tcp
                        destination-port {
                            operator eq
                            value 57401
                        }
                    }
                }
                entry 360 {
                    description "Accept incoming p4rt packets with destination-port 9559"
                    action {
                        accept {
                        }
                    }
                    match {
                        protocol tcp
                        destination-port {
                            operator eq
                            value 9559
                        }
                    }
                }
                entry 370 {
                    description "Accept incoming IGMP packets"
                    action {
                        accept {
                        }
                    }
                    match {
                        protocol igmp
                    }
                }
                entry 380 {
                    description "Drop all else"
                    action {
                        drop {
                            log true
                        }
                    }
                }
            }
            ipv6-filter {
                statistics-per-entry true
                entry 10 {
                    description "Accept incoming ICMPv6 unreachable messages"
                    action {
                        accept {
                            rate-limit {
                                system-cpu-policer icmp
                            }
                        }
                    }
                    match {
                        next-header icmp6
                        icmp6 {
                            type dest-unreachable
                            code [
                                0
                                1
                                2
                                3
                                4
                                5
                                6
                            ]
                        }
                    }
                }
                entry 20 {
                    description "Accept incoming ICMPv6 packet-too-big messages"
                    action {
                        accept {
                            rate-limit {
                                system-cpu-policer icmp
                            }
                        }
                    }
                    match {
                        next-header icmp6
                        icmp6 {
                            type packet-too-big
                        }
                    }
                }
                entry 30 {
                    description "Accept incoming ICMPv6 time-exceeded messages"
                    action {
                        accept {
                            rate-limit {
                                system-cpu-policer icmp
                            }
                        }
                    }
                    match {
                        next-header icmp6
                        icmp6 {
                            type time-exceeded
                        }
                    }
                }
                entry 40 {
                    description "Accept incoming ICMPv6 parameter problem messages"
                    action {
                        accept {
                            rate-limit {
                                system-cpu-policer icmp
                            }
                        }
                    }
                    match {
                        next-header icmp6
                        icmp6 {
                            type param-problem
                        }
                    }
                }
                entry 50 {
                    description "Accept incoming ICMPv6 echo-request messages"
                    action {
                        accept {
                            rate-limit {
                                system-cpu-policer icmp
                            }
                        }
                    }
                    match {
                        next-header icmp6
                        icmp6 {
                            type echo-request
                        }
                    }
                }
                entry 60 {
                    description "Accept incoming ICMPv6 echo-reply messages"
                    action {
                        accept {
                            rate-limit {
                                system-cpu-policer icmp
                            }
                        }
                    }
                    match {
                        next-header icmp6
                        icmp6 {
                            type echo-reply
                        }
                    }
                }
                entry 70 {
                    description "Accept incoming ICMPv6 router-advertisement messages"
                    action {
                        accept {
                            rate-limit {
                                system-cpu-policer icmp
                            }
                        }
                    }
                    match {
                        next-header icmp6
                        icmp6 {
                            type router-advertise
                        }
                    }
                }
                entry 80 {
                    description "Accept incoming ICMPv6 neighbor-solicitation messages"
                    action {
                        accept {
                            rate-limit {
                                system-cpu-policer icmp
                            }
                        }
                    }
                    match {
                        next-header icmp6
                        icmp6 {
                            type neighbor-solicit
                        }
                    }
                }
                entry 90 {
                    description "Accept incoming ICMPv6 neighbor-advertisement messages"
                    action {
                        accept {
                            rate-limit {
                                system-cpu-policer icmp
                            }
                        }
                    }
                    match {
                        next-header icmp6
                        icmp6 {
                            type neighbor-advertise
                        }
                    }
                }
                entry 100 {
                    description "Accept incoming SSH when the other host initiates the TCP connection"
                    action {
                        accept {
                        }
                    }
                    match {
                        next-header tcp
                        destination-port {
                            operator eq
                            value 22
                        }
                    }
                }
                entry 110 {
                    description "Accept incoming SSH when this router initiates the TCP connection"
                    action {
                        accept {
                        }
                    }
                    match {
                        next-header tcp
                        source-port {
                            operator eq
                            value 22
                        }
                    }
                }
                entry 120 {
                    description "Accept incoming Telnet when the other host initiates the TCP connection"
                    action {
                        accept {
                        }
                    }
                    match {
                        next-header tcp
                        destination-port {
                            operator eq
                            value 23
                        }
                    }
                }
                entry 130 {
                    description "Accept incoming Telnet when this router initiates the TCP connection"
                    action {
                        accept {
                        }
                    }
                    match {
                        next-header tcp
                        source-port {
                            operator eq
                            value 23
                        }
                    }
                }
                entry 140 {
                    description "Accept incoming TACACS+ when the other host initiates the TCP connection"
                    action {
                        accept {
                        }
                    }
                    match {
                        next-header tcp
                        destination-port {
                            operator eq
                            value 49
                        }
                    }
                }
                entry 150 {
                    description "Accept incoming TACACS+ when this router initiates the TCP connection"
                    action {
                        accept {
                        }
                    }
                    match {
                        next-header tcp
                        source-port {
                            operator eq
                            value 49
                        }
                    }
                }
                entry 160 {
                    description "Accept incoming DNS response messages"
                    action {
                        accept {
                        }
                    }
                    match {
                        next-header udp
                        source-port {
                            operator eq
                            value 53
                        }
                    }
                }
                entry 170 {
                    description "Accept incoming TFTP read-request and write-request messages"
                    action {
                        accept {
                        }
                    }
                    match {
                        next-header udp
                        destination-port {
                            operator eq
                            value 69
                        }
                    }
                }
                entry 180 {
                    description "Accept incoming HTTP(JSON-RPC) when the other host initiates the TCP connection"
                    action {
                        accept {
                        }
                    }
                    match {
                        next-header tcp
                        destination-port {
                            operator eq
                            value 80
                        }
                    }
                }
                entry 190 {
                    description "Accept incoming HTTP(JSON-RPC) when this router initiates the TCP connection"
                    action {
                        accept {
                        }
                    }
                    match {
                        next-header tcp
                        source-port {
                            operator eq
                            value 80
                        }
                    }
                }
                entry 200 {
                    description "Accept incoming NTP messages from servers"
                    action {
                        accept {
                        }
                    }
                    match {
                        next-header udp
                        source-port {
                            operator eq
                            value 123
                        }
                    }
                }
                entry 210 {
                    description "Accept incoming SNMP GET/GETNEXT messages from servers"
                    action {
                        accept {
                        }
                    }
                    match {
                        next-header udp
                        destination-port {
                            operator eq
                            value 161
                        }
                    }
                }
                entry 220 {
                    description "Accept incoming BGP when the other router initiates the TCP connection"
                    action {
                        accept {
                        }
                    }
                    match {
                        next-header tcp
                        destination-port {
                            operator eq
                            value 179
                        }
                    }
                }
                entry 230 {
                    description "Accept incoming BGP when this router initiates the TCP connection"
                    action {
                        accept {
                        }
                    }
                    match {
                        next-header tcp
                        source-port {
                            operator eq
                            value 179
                        }
                    }
                }
                entry 240 {
                    description "Accept incoming HTTPS(JSON-RPC) when the other host initiates the TCP connection"
                    action {
                        accept {
                        }
                    }
                    match {
                        next-header tcp
                        destination-port {
                            operator eq
                            value 443
                        }
                    }
                }
                entry 250 {
                    description "Accept incoming HTTPS(JSON-RPC) when this router initiates the TCP connection"
                    action {
                        accept {
                        }
                    }
                    match {
                        next-header tcp
                        source-port {
                            operator eq
                            value 443
                        }
                    }
                }
                entry 260 {
                    description "Accept incoming DHCPv6 client messages"
                    action {
                        accept {
                        }
                    }
                    match {
                        next-header udp
                        destination-port {
                            operator eq
                            value 546
                        }
                    }
                }
                entry 270 {
                    description "Accept incoming single-hop BFD session messages"
                    action {
                        accept {
                        }
                    }
                    match {
                        next-header udp
                        destination-port {
                            operator eq
                            value 3784
                        }
                    }
                }
                entry 280 {
                    description "Accept incoming multi-hop BFD session messages"
                    action {
                        accept {
                        }
                    }
                    match {
                        next-header udp
                        destination-port {
                            operator eq
                            value 4784
                        }
                    }
                }
                entry 290 {
                    description "Accept incoming uBFD session messages"
                    action {
                        accept {
                        }
                    }
                    match {
                        next-header udp
                        destination-port {
                            operator eq
                            value 6784
                        }
                    }
                }
                entry 300 {
                    description "Accept incoming gNMI messages when the other host initiates the TCP connection"
                    action {
                        accept {
                        }
                    }
                    match {
                        next-header tcp
                        destination-port {
                            operator eq
                            value 57400
                        }
                    }
                }
                entry 310 {
                    description "Accept incoming UDP traceroute messages"
                    action {
                        accept {
                        }
                    }
                    match {
                        next-header udp
                        destination-port {
                            range {
                                start 33434
                                end 33464
                            }
                        }
                    }
                }
                entry 320 {
                    description "Accept incoming IPV6 hop-in-hop messages"
                    action {
                        accept {
                        }
                    }
                    match {
                        next-header 0
                    }
                }
                entry 330 {
                    description "Accept incoming IPV6 fragment header messages"
                    action {
                        accept {
                        }
                    }
                    match {
                        next-header 44
                    }
                }
                entry 340 {
                    description "Accept incoming OSPF messages"
                    action {
                        accept {
                        }
                    }
                    match {
                        next-header 89
                    }
                }
                entry 350 {
                    description "Accept incoming DHCPv6 relay messages"
                    action {
                        accept {
                        }
                    }
                    match {
                        next-header udp
                        destination-port {
                            operator eq
                            value 547
                        }
                    }
                }
                entry 360 {
                    description "Accept incoming gRIBI packets with destination-port 57401"
                    action {
                        accept {
                        }
                    }
                    match {
                        next-header tcp
                        destination-port {
                            operator eq
                            value 57401
                        }
                    }
                }
                entry 370 {
                    description "Accept incoming p4rt packets with destination-port 9559"
                    action {
                        accept {
                        }
                    }
                    match {
                        next-header tcp
                        destination-port {
                            operator eq
                            value 9559
                        }
                    }
                }
                entry 380 {
                    description "Accept incoming IGMP packets"
                    action {
                        accept {
                        }
                    }
                    match {
                        next-header igmp
                    }
                }
                entry 390 {
                    description "Drop all else"
                    action {
                        drop {
                            log true
                        }
                    }
                }
            }
        }
        policers {
            system-cpu-policer icmp {
                entry-specific false
                peak-packet-rate 1000
                max-packet-burst 1000
            }
        }
    }
    interface ethernet-1/1 {
        admin-state enable
    }
    interface ethernet-1/51 {
        admin-state enable
    }
    interface ethernet-1/52 {
        admin-state enable
    }
    interface mgmt0 {
        admin-state enable
        subinterface 0 {
            admin-state enable
            ipv4 {
                dhcp-client {
                }
            }
            ipv6 {
                dhcp-client {
                }
            }
        }
    }
    system {
        aaa {
            authentication {
                idle-timeout 7200
                authentication-method [
                    local
                ]
            }
            server-group local {
                type local
            }
        }
        lldp {
            admin-state enable
        }
         tls {
         }
         ssh-server {
            network-instance mgmt {
                admin-state enable
            }
        }
         logging {
            buffer messages {
                rotate 3
                size 10000000
                facility local6 {
                    priority {
                        match-above informational
                    }
                }
            }
            buffer system {
                facility auth {
                    priority {
                        match-above warning
                    }
                }
                facility cron {
                    priority {
                        match-above warning
                    }
                }
                facility daemon {
                    priority {
                        match-above warning
                    }
                }
                facility ftp {
                    priority {
                        match-above warning
                    }
                }
                facility kern {
                    priority {
                        match-above warning
                    }
                }
                facility lpr {
                    priority {
                        match-above warning
                    }
                }
                facility mail {
                    priority {
                        match-above warning
                    }
                }
                facility news {
                    priority {
                        match-above warning
                    }
                }
                facility syslog {
                    priority {
                        match-above warning
                    }
                }
                facility user {
                    priority {
                        match-above warning
                    }
                }
                facility uucp {
                    priority {
                        match-above warning
                    }
                }
                facility local0 {
                    priority {
                        match-above warning
                    }
                }
                facility local1 {
                    priority {
                        match-above warning
                    }
                }
                facility local2 {
                    priority {
                        match-above warning
                    }
                }
                facility local3 {
                    priority {
                        match-above warning
                    }
                }
                facility local4 {
                    priority {
                        match-above warning
                    }
                }
                facility local5 {
                    priority {
                        match-above warning
                    }
                }
                facility local7 {
                    priority {
                        match-above warning
                    }
                }
            }
            file messages {
                rotate 3
                size 10000000
                facility local6 {
                    priority {
                        match-above warning
                    }
                }
            }
        }
    }
    network-instance mgmt {
        type ip-vrf
        admin-state enable
        description "Management network instance"
        interface mgmt0.0 {
        }
        protocols {
            linux {
                import-routes true
                export-routes true
                export-neighbors true
            }
        }
    }
